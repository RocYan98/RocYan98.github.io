import{_ as m,r as l,o as r,c,b as s,e as a,d as t,w as p,f as e}from"./app-3e76cd48.js";const o={},h=e('<h2 id="nerf-是做什么的" tabindex="-1"><a class="header-anchor" href="#nerf-是做什么的" aria-hidden="true">#</a> NeRF 是做什么的</h2><p>想知道一个模型是干什么的，最简单的方式就是看这个模型的输入输出。先忽略内部细节，NeRF 的输入就是对一个物体从不同角度拍摄的多张图片，输出就是渲染出来的输入集中所没有的新视角下的图片 (如图 1 所展示的那样)，简而言之 NeRF 就是合成新视角下的视图的模型。</p><figure><img src="https://rocyan.oss-cn-hangzhou.aliyuncs.com/blog/202406261139040.png" alt="Fig. 1: Overview" tabindex="0" loading="lazy"><figcaption>Fig. 1: Overview</figcaption></figure><h2 id="nerf-是怎么做的" tabindex="-1"><a class="header-anchor" href="#nerf-是怎么做的" aria-hidden="true">#</a> NeRF 是怎么做的</h2><figure><img src="https://rocyan.oss-cn-hangzhou.aliyuncs.com/blog/202406261139365.png" alt="Fig. 2：Pipeline" tabindex="0" loading="lazy"><figcaption>Fig. 2：Pipeline</figcaption></figure><h3 id="pipeline" tabindex="-1"><a class="header-anchor" href="#pipeline" aria-hidden="true">#</a> Pipeline</h3><ul><li>(a). 沿着每个像素的光线进行采样，将采样点的 3 维空间坐标和 2 维视角输入 MLP。</li><li>(b). 通过 MLP 计算出每个采样点的颜色和密度。</li><li>(c). 通过体渲染技术渲染出每个像素的颜色并合成图像。</li><li>(d). 体渲染的函数是可微的，因此通过损失函数 (损失函数是计算渲染出的像素颜色和真实像素颜色之间的平方差) 来优化模型。</li></ul><h3 id="实现细节" tabindex="-1"><a class="header-anchor" href="#实现细节" aria-hidden="true">#</a> 实现细节</h3><h4 id="采样" tabindex="-1"><a class="header-anchor" href="#采样" aria-hidden="true">#</a> 采样</h4>',9),d=s("strong",null,"分层采样 (Hierarchical Sampling)",-1),u=s("strong",null,"粗网络 (Coarse)",-1),g=s("strong",null,"细网络 (Fine)",-1),x=s("strong",null,"逆变换采样 (Inverse Transform Sampling)",-1),y=s("figure",null,[s("img",{src:"https://rocyan.oss-cn-hangzhou.aliyuncs.com/blog/202406261139904.png",alt:"Fig. 3：分层采样",tabindex:"0",loading:"lazy"}),s("figcaption",null,"Fig. 3：分层采样")],-1),f=s("h4",{id:"位置编码",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#位置编码","aria-hidden":"true"},"#"),a(" 位置编码")],-1),b=s("strong",null,"位置编码 (Positional Encoding)",-1),w={href:"https://bmild.github.io/fourfeat/index.html",title:"Fourier Features Let Networks Learn High Frequency Functions in Low Dimensional Domains",target:"_blank",rel:"noopener noreferrer"},k=s("strong",null,"傅里叶特征映射 (Fourier Features Mapping)",-1),_=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mtable",{width:"100%"},[s("mtr",null,[s("mtd",{width:"50%"}),s("mtd",null,[s("mrow",null,[s("mi",null,"γ"),s("mo",{stretchy:"false"},"("),s("mi",null,"p"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mo",{stretchy:"false"},"("),s("mi",null,"sin"),s("mo",null,"⁡"),s("mo",{stretchy:"false"},"("),s("msup",null,[s("mn",null,"2"),s("mn",null,"0")]),s("mi",null,"π"),s("mi",null,"p"),s("mo",{stretchy:"false"},")"),s("mo",{separator:"true"},","),s("mi",null,"cos"),s("mo",null,"⁡"),s("mo",{stretchy:"false"},"("),s("msup",null,[s("mn",null,"2"),s("mn",null,"0")]),s("mi",null,"π"),s("mi",null,"p"),s("mo",{stretchy:"false"},")"),s("mo",{separator:"true"},","),s("mo",null,"⋯"),s("mtext",null," "),s("mo",{separator:"true"},","),s("mi",null,"sin"),s("mo",null,"⁡"),s("mo",{stretchy:"false"},"("),s("msup",null,[s("mn",null,"2"),s("mrow",null,[s("mi",null,"L"),s("mo",null,"−"),s("mn",null,"1")])]),s("mi",null,"π"),s("mi",null,"p"),s("mo",{stretchy:"false"},")"),s("mo",{separator:"true"},","),s("mi",null,"cos"),s("mo",null,"⁡"),s("mo",{stretchy:"false"},"("),s("msup",null,[s("mn",null,"2"),s("mrow",null,[s("mi",null,"L"),s("mo",null,"−"),s("mn",null,"1")])]),s("mi",null,"π"),s("mi",null,"p"),s("mo",{stretchy:"false"},")"),s("mo",{stretchy:"false"},")")])]),s("mtd",{width:"50%"}),s("mtd",null,[s("mtext",null,"(1)")])])]),s("annotation",{encoding:"application/x-tex"}," \\gamma(p)=(\\sin(2^0\\pi p),\\cos(2^0\\pi p),\\cdots,\\sin(2^{L-1}\\pi p),\\cos(2^{L-1}\\pi p)) \\tag{1} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05556em"}},"γ"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1413em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mop"},"sin"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},"2"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])])])])])]),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"π"),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mop"},"cos"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},"2"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])])])])])]),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"π"),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"minner"},"⋯"),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mop"},"sin"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},"2"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"L"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"π"),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},")"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mop"},"cos"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},"2"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"L"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"π"),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mclose"},"))")]),s("span",{class:"tag"},[s("span",{class:"strut",style:{height:"1.1413em","vertical-align":"-0.25em"}}),s("span",{class:"mord text"},[s("span",{class:"mord"},"("),s("span",{class:"mord"},[s("span",{class:"mord"},"1")]),s("span",{class:"mord"},")")])])])])])],-1),L=s("p",null,[a("可以将参数从 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"double-struck"},"R")]),s("annotation",{encoding:"application/x-tex"},"\\R")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6889em"}}),s("span",{class:"mord mathbb"},"R")])])]),a(" 映射到更高维的空间 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",{mathvariant:"double-struck"},"R"),s("mrow",null,[s("mn",null,"2"),s("mi",null,"L")])])]),s("annotation",{encoding:"application/x-tex"},"\\R^{2L}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8413em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbb"},"R"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8413em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"2"),s("span",{class:"mord mathnormal mtight"},"L")])])])])])])])])])])]),a("，NeRF 中对空间坐标 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mtext",{mathvariant:"bold"},"x")]),s("annotation",{encoding:"application/x-tex"},"\\textbf{x}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4444em"}}),s("span",{class:"mord text"},[s("span",{class:"mord textbf"},"x")])])])]),a(" 和视角 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mtext",{mathvariant:"bold"},"d")]),s("annotation",{encoding:"application/x-tex"},"\\textbf{d}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord text"},[s("span",{class:"mord textbf"},"d")])])])]),a(" 分别设置 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"L"),s("mo",null,"="),s("mn",null,"10")]),s("annotation",{encoding:"application/x-tex"},"L=10")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"L"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"10")])])]),a(" 和 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"L"),s("mo",null,"="),s("mn",null,"4")]),s("annotation",{encoding:"application/x-tex"},"L=4")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"L"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"4")])])]),a("，即将 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mtext",{mathvariant:"bold"},"x")]),s("annotation",{encoding:"application/x-tex"},"\\textbf{x}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4444em"}}),s("span",{class:"mord text"},[s("span",{class:"mord textbf"},"x")])])])]),a(" 和 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mtext",{mathvariant:"bold"},"d")]),s("annotation",{encoding:"application/x-tex"},"\\textbf{d}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord text"},[s("span",{class:"mord textbf"},"d")])])])]),a(" 都从 3 维 (在论文中视角 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mtext",{mathvariant:"bold"},"d"),s("mo",null,"="),s("mo",{stretchy:"false"},"("),s("mi",null,"θ"),s("mo",{separator:"true"},","),s("mi",null,"ϕ"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"\\textbf{d}=(\\theta,\\phi)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord text"},[s("span",{class:"mord textbf"},"d")]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"θ"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal"},"ϕ"),s("span",{class:"mclose"},")")])])]),a("​​ 是 2 维的，但是输入模型前会转换成 3 维) 分别映射到 60 维和 24 维。当把输入从低维转换到高维之后，就可以让 MLP 学会高频信息。")],-1),F=e('<figure><img src="https://rocyan.oss-cn-hangzhou.aliyuncs.com/blog/202406261139614.gif" alt="Fig. 4：有无傅里叶特征对训练结果的影响" tabindex="0" loading="lazy"><figcaption>Fig. 4：有无傅里叶特征对训练结果的影响</figcaption></figure><p>图像中的高频信息是灰度变化比较大的地方，也就是边缘和纹理，图 4 中也可以看出，没有使用位置编码，学习出来的图像在边缘和纹理上效果很差。</p><h4 id="模型" tabindex="-1"><a class="header-anchor" href="#模型" aria-hidden="true">#</a> 模型</h4><p>NeRF 的模型架构如图 5 所示，并且具体代码实现用相同颜色的框进行了标注。</p><figure><img src="https://rocyan.oss-cn-hangzhou.aliyuncs.com/blog/202406261139204.png" alt="Fig. 5：模型" tabindex="0" loading="lazy"><figcaption>Fig. 5：模型</figcaption></figure><h4 id="体渲染" tabindex="-1"><a class="header-anchor" href="#体渲染" aria-hidden="true">#</a> 体渲染</h4><h2 id="nerf-做的怎么样" tabindex="-1"><a class="header-anchor" href="#nerf-做的怎么样" aria-hidden="true">#</a> NeRF 做的怎么样</h2><h2 id="reference" tabindex="-1"><a class="header-anchor" href="#reference" aria-hidden="true">#</a> Reference</h2>',8),M={href:"https://bmild.github.io/fourfeat/index.html",target:"_blank",rel:"noopener noreferrer"},v={href:"https://www.matthewtancik.com/nerf",target:"_blank",rel:"noopener noreferrer"};function z(R,N){const i=l("RouterLink"),n=l("ExternalLinkIcon");return r(),c("div",null,[h,s("p",null,[a("NeRF 在采样中使用了一个 trick，就是"),d,a("，简单来说就是训练两个网络 ，"),u,a(" 和"),g,a("。粗网络会沿着光线均匀采样 64 个点，通过粗网络的结果可以知道 Volume 中哪些地方密度更大更值得被采样 (原理在 "),t(i,{to:"/posts/paper/representation/pre-knowledge.html"},{default:p(()=>[a("前置知识 (4.2节)")]),_:1}),a(" 中有详细解释)。细网络会采样 64 + 128 个点，其中 64 个就是粗网络采样的点，剩下 128 个是基于粗网络的结果，使用"),x,a(" 的方法在密度大的地方进行采样。")]),y,f,s("p",null,[a("NeRF 中的另一个 trick，就是"),b,a("。NeRF 的团队在他们的另一篇论文中"),s("a",w,[a("[1]"),t(n)]),a(" 表明 MLP 更倾向于学习低频信息。解决这个问题的方法就是位置编码，使用"),k,a("：")]),_,L,F,s("p",null,[s("a",M,[a("[1]Fourier Features Let Networks Learn High Frequency Functions in Low Dimensional Domains"),t(n)])]),s("p",null,[s("a",v,[a("[2]NeRF: Representing Scenes as Neural Radiance Fields for View Synthesis"),t(n)])])])}const V=m(o,[["render",z],["__file","NeRF-analysis.html.vue"]]);export{V as default};
